"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}var body=document.body,docEl=document.documentElement,grid=document.querySelector(".speaker-grid"),speakers=[].concat(_toConsumableArray(grid.querySelectorAll(".speaker"))),contents=[].concat(_toConsumableArray(document.querySelectorAll(".content > .content-item"))),closeTheSpeaker=document.querySelector(".content__close"),contentWrapper=document.querySelector("#content"),contentPattern=document.querySelector(".content > .content__pattern"),scrollPos=void 0,activeSpeaker=void 0,winsize=void 0,calcWinsize=function e(){return winsize={width:window.innerWidth,height:window.innerHeight}};calcWinsize();var getOffset=function e(t,o){var n=0,r="top"===o?"offsetTop":"offsetLeft";do{isNaN(t[r])||(n+=t[r])}while(t=t.offsetParent);return n},keys={37:1,38:1,39:1,40:1},preventDefault=function e(t){t=t||window.event,t.preventDefault&&t.preventDefault(),t.returnValue=!1},preventDefaultForScrollKeys=function e(t){if(keys[t.keyCode])return preventDefault(t),!1},disableScroll=function e(){window.addEventListener&&window.addEventListener("DOMMouseScroll",preventDefault,!1),window.onwheel=preventDefault,window.onmousewheel=document.onmousewheel=preventDefault,window.ontouchmove=preventDefault,document.onkeydown=preventDefaultForScrollKeys},enableScroll=function e(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventDefault,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null},hideOthers=function e(){var t=document.querySelectorAll(".speaker:not(.exclude)");TweenMax.staggerTo(t,.8,{scale:0,opacity:0,ease:Expo.easeInOut})},showOthers=function e(){var t=document.querySelectorAll(".speaker:not(.exclude)");TweenMax.staggerTo(t,.8,{scale:1,opacity:1,ease:Expo.easeInOut,onComplete:function e(){t.forEach(function(e){e.style.transform="none"})}})},hideTexts=function e(t,o){TweenMax.to([t,o],.5,{ease:Quart.easeIn,delay:0,y:20,opacity:0})},showTexts=function e(t,o){TweenMax.to([t,o],1,{ease:Expo.easeOut,delay:1,y:0,opacity:1})},showContentElems=function e(t,o){var n=t.querySelector(".content-item__title"),r=t.querySelector(".content-item__text"),i=document.querySelector(".content > .content__close");n.classList.contains("charmed")||(charming(n),n.classList.add("charmed"));var a=n.querySelectorAll("span");TweenMax.to([i,r,contentPattern],.8,{ease:Expo.easeOut,delay:o,startAt:{y:60},y:0,opacity:1}),setTimeout(function(){a.forEach(function(e,t){var o=.05*t;TweenMax.to(e,.6,{ease:Back.easeOut,delay:o,startAt:{yPercent:"50%",opacity:0},yPercent:"0",opacity:1})})},1e3)},hideContentElems=function e(t,o){var n=t.querySelector(".content-item__title"),r=t.querySelector(".content-item__text"),i=t.querySelector(".content-item__position"),a=document.querySelector(".content > .content__close"),s=n.querySelectorAll("span"),l=s.length;TweenMax.to([a,r,contentPattern,i],.8,{ease:Expo.easeIn,delay:0,startAt:null,y:60,opacity:0}),s.forEach(function(e,t){TweenMax.to(e,.3,{ease:Quart.easeIn,delay:.04*(l-t-1),yPercent:"50%",startAt:null,opacity:0})})},getSizePosition=function e(t){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=window.pageYOffset||docEl.scrollTop||body.scrollTop,r=window.pageXOffset||docEl.scrollLeft||body.scrollLeft;return{width:t.offsetWidth,height:t.offsetHeight,left:o?getOffset(t,"left")-r:getOffset(t,"left"),top:o?getOffset(t,"top")-n:getOffset(t,"top")}};imagesLoaded(document.querySelectorAll(".speaker-img"),function(){body.classList.remove("loading");var e=new Masonry(grid,{itemSelector:".speaker",columnWidth:260,gutter:100,fitWidth:!0})}),speakers.forEach(function(e){var t=e.querySelector(".speaker__name");charming(t);var o=t.querySelectorAll("span");e.addEventListener("mouseenter",function(){animationHover(e,"mouseenter",o)}),e.addEventListener("mouseleave",function(){animationHover(e,"mouseleave",o)}),e.addEventListener("click",function(t){t.preventDefault(),openSpeaker(e)})}),closeTheSpeaker.addEventListener("click",function(e){e.preventDefault();var t=document.querySelector(".content-item--current");closeItem(t)});var openSpeaker=function e(t){if(!t.isAnimating){t.isAnimating=!0,console.log(t);var o=t.querySelector(".speaker__bg"),n=t.querySelector(".speaker__wrap"),r=t.querySelector(".speaker__img"),i=t.querySelector(".speaker__name"),a=t.querySelector(".speaker__keynote"),s=document.querySelector(".speaker-grid");t.classList.add("exclude"),scrollPos=window.scrollY,disableScroll();var l=speakers.indexOf(t);activeSpeaker=l,hideOthers(),hideTexts(i,a);var c=getSizePosition(t);console.log(c),o.style.width=c.width+"px",o.style.height=c.height+"px",o.style.left=c.left+"px",o.style.top=c.top+"px",o.style.position="fixed",t.style.zIndex="1000";var u=Math.hypot(winsize.width,winsize.height);TweenMax.to(o,1.2,{ease:Expo.easeInOut,delay:.4,x:winsize.width/2-(c.left+c.width/2),y:winsize.height/2-(c.top+c.height/2),scaleX:u/c.width,scaleY:u/c.height});var d=contents[l];d.classList.add("content-item--current");var p=getSizePosition(n),y=getSizePosition(d.querySelector(".content-item__img"),!1);showContentElems(d,1),TweenMax.to(r,1.2,{ease:Expo.easeInOut,delay:.55,scaleX:y.width/p.width,scaleY:y.height/p.height,x:y.left+y.width/2-(p.left+p.width/2),y:y.top+y.height/2-(p.top+p.height/2),rotation:0,onComplete:function e(){r.style.opacity=0,d.querySelector(".content-item__img").style.visibility="visible",contentWrapper.style.position="initial",d.parentNode.style.position="absolute",s.classList.add("grid-wrap--hidden"),window.scrollTo(0,0),enableScroll(),t.isAnimating=!1}})}},closeItem=function e(t){if(!t.isAnimating){t.isAnimating=!0;var o=document.querySelector(".speaker-grid"),n=contents[activeSpeaker],r=n.querySelector(".content-item__img");window.scrollTo(0,scrollPos),n.parentNode.style.position="fixed",disableScroll(),o.classList.remove("grid-wrap--hidden");var i=speakers[activeSpeaker],a=i.querySelector(".speaker__img"),s=i.querySelector(".speaker__bg"),l=i.querySelector(".speaker__name"),c=i.querySelector(".speaker__keynote");hideContentElems(n,0),a.style.opacity=1,r.style.visibility="hidden",TweenMax.to(a,1.2,{ease:Expo.easeInOut,scaleX:1,scaleY:1,x:0,y:0,rotation:2*i.angle}),TweenMax.to(s,1.2,{ease:Expo.easeInOut,delay:.15,x:0,y:0,scaleX:1,scaleY:1,rotation:0,onComplete:function e(){n.classList.remove("content-item--current"),i.classList.remove("exclude"),contentWrapper.style.position="relative",s.style.position="absolute",s.style.left="0px",s.style.top="0px",activeSpeaker=-1,i.style.zIndex=0,enableScroll(),t.isAnimating=!1}}),showOthers(),showTexts(l,c)}},animationHover=function e(t,o,n){if(window.innerWidth>990){var r=t.querySelector(".speaker__bg");TweenMax.to(r,1,{ease:Expo.easeOut,scale:"mouseenter"===o?1.15:1}),n.forEach(function(e,t){TweenMax.to(e,.2,{ease:Quad.easeIn,delay:.1*t,yPercent:"mouseenter"===o?"-50%":"50%",opacity:0,onComplete:function t(){TweenMax.to(e,"mouseenter"===o?.6:1,{ease:"mouseenter"===o?Expo.easeOut:Elastic.easeOut.config(1,.4),startAt:{yPercent:"mouseenter"===o?"70%":"-70%",opacity:0},yPercent:"0%",opacity:1})}})})}};